<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="es">
<head>
	<meta th:replace="static/cabeceraMeta :: meta">
	<link th:replace="static/cabeceraLink :: link">
	<script th:replace="static/cabeceraScript :: script"></script>

	<title>Selecci贸n torneo</title>

	<script type="text/javascript">
		function cargarGimnasios(tournamentType) {
			var id = document.getElementById("torneo").value;
			var relativeUrl = "formulario/selectTournament/" + tournamentType + "/" + id;
			var domain = getDomain(location.href);
			location.href = domain + relativeUrl;
		}

		function cargarFormulario(tournamentType) {
			var idTorneo = document.getElementById("torneo").value;
			var idGimnasio = document.getElementById("gimnasio").value;
			var relativeUrl = "formulario/cargar-formulario/" + tournamentType + "/" + idTorneo + "/" + idGimnasio;
			var domain = getDomain(location.href);
			location.href = domain + relativeUrl;
		}

        function goDetail(id,propia){
            var relativeUrl;
            if(propia == 'true'){
            	relativeUrl = "formulario/getPropia/" + id;
            } else {
            	relativeUrl = "formulario/getMenorOInclisivo/" + id;
            }
            var domain = getDomain(location.href);
            location.href = domain + relativeUrl;
        }
	</script>
</head>
<body>
	<div th:replace="static/barraUsuario :: div"></div>
	<div th:replace="static/barraNav :: nav"></div>

	<div class="container">

		<section class="margenArribaAbajo3Porc text-center">
			<div th:if="${errorMessage != null}" class="alert alert-danger" role="alert"><span th:text="${errorMessage}"></span></div>
		</section>

		<div class="row align-items-center justify-content-end">
			<div class="col-md-2">
			</div>
			<div class="col-6 col-md-8 colorGreen">
				<h1>Selecci贸n del torneo</h1>
			</div>
			<div class="col-3 col-md-2">
				<a class="btn btn-info" href="#" th:href="@{/tournamentRegistration/mainPage}">Volver</a>
			</div>
		</div>

		<section class="margenArribaAbajo3Porc text-center">

			<div class="row mb-1">
				<div class="col-12">
					<label for="torneo">Lista de torneos con inscripci贸n abierta</label>
				</div>
			</div>

			<div class="row mb-3">
				<div class="col-md-3">
				</div>
				<div class="col-12 col-md-6">
					<select name="torneo" id="torneo" class="form-select" th:attr="onchange=|cargarGimnasios('${tournamentType}')|">
						<option th:each="unit : ${torneoModelList}" th:value="${unit.id}" th:text="${unit.nombre}+' - '+${#calendars.format(unit.fechaTorneo,'dd/MM/yyyy')}" th:selected="${unit.id==torneoModel.id}"></option>
					</select>
				</div>
				<div class="col-md-3">
				</div>
			</div>

		</section>

		<section th:if="${torneoGimnasioModelList != null}" class="margenArribaAbajo3Porc text-center">

			<div class="row mb-1">
				<div class="col-12">
					<label for="gimnasio">Seleccione gimnasio</label>
				</div>
			</div>

			<div class="row mb-3">
				<div class="col-md-3">
				</div>
				<div class="col-12 col-md-6">
					<select name="gimnasio" id="gimnasio" class="form-select">
						<option th:each="unit : ${torneoGimnasioModelList}" th:value="${unit.id}" th:text="${unit.nombreGimnasio}"></option>
					</select>
				</div>
				<div class="col-md-3">
				</div>
			</div>

			<div class="row mb-1">
				<div class="col-12">
					<button class="btn btn-primary" th:attr="onclick=|cargarFormulario('${tournamentType}')|">Formulario</button>
				</div>
			</div>

		</section>

		<section sec:authorize="isAuthenticated()">
			<table class="table table-striped table-hover">
				<thead>
				<tr>
					<th scope="col">Fecha inscripci贸n</th>
					<th scope="col">Participante</th>
					<th scope="col">Nombre torneo</th>
					<th scope="col">Fecha torneo</th>
				</tr>
				</thead>
				<tbody>
				<tr th:each="tournamentRegistration : ${inscripciones}" th:attr="onclick=|goDetail('${tournamentRegistration.id}','${tournamentRegistration.inscripcionPropia}')|">
					<td><span th:text="${#calendars.format(tournamentRegistration.fechaInscripcion,'dd/MM/yyyy HH:mm')}"></span></td>
					<td><span th:text="${tournamentRegistration.nombre+' '+tournamentRegistration.apellido1+' '+tournamentRegistration.apellido2}"></span></td>
					<td><span th:text="${tournamentRegistration.nombreTorneo}"></span></td>
					<td><span th:text="${tournamentRegistration.fechaTorneo}"></span></td>
				</tr>
				</tbody>
			</table>
		</section>
		
	</div>
</body>

<footer th:replace="static/footer :: footer"></footer>
</html>