<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="es">
<head>
	<meta th:replace="static/cabeceraMeta :: meta">
	<link th:replace="static/cabeceraLink :: link">
	<script th:replace="static/cabeceraScript :: script"></script>

	<title>Principal mandato</title>

	<script type="text/javascript">
        function goDetail(id,propia){
            var relativeUrl;
            if(propia == 'true'){
            	relativeUrl = "formulario/getPropia/" + id;
            } else {
            	relativeUrl = "formulario/getMenorOInclisivo/" + id;
            }
            var domain = getDomain(location.href);
            location.href = domain + relativeUrl;
        }

		function confirmDelete(id){
			if(confirm("¿Seguro que desea eliminar el mandato?")){
				var relativeUrl = "mandato/remove/" + id;
				var domain = getDomain(location.href);
				location.href = domain + relativeUrl;
				return true;
			}
			return false;
		}
	</script>
</head>
<body>
	<div th:replace="static/barraUsuario :: div"></div>
	<div th:replace="static/barraNav :: nav"></div>
	
	<div class="container">

		<section class="margenArribaAbajo3Porc text-center">
			<div th:if="${deleteOK != null}" class="alert alert-success textAlignCenter" role="alert"><span th:text="${deleteOK}"></span></div>
		</section>

		<div class="row align-items-center justify-content-end">
			<div class="col-md-2">
			</div>
			<div class="col-6 col-md-8 colorGreen">
				<h1>Mandatos para tramitación de Licencia Federativa</h1>
			</div>
			<div class="col-3 col-md-2">
				<a class="btn btn-info" href="#" th:href="@{/principal/}">Volver</a>
			</div>
		</div>

		<section>
			<div class="row align-items-center text-center">
				<div class="col-12">
					La Licencia Federativa es individual y se debe realizar cada año. Para cada tramitación de Licencia
					Federativa se necesita un mandato.
				</div>
			</div>
			<div class="row align-items-center justify-content-center text-center">
				<div class="col-12 col-md-6">
					<a href="#" th:href="@{/mandato/adulto}" class="textDecoration-none">
						<button class="btn btn-primary anchoMinimo50 margenArribaAbajo3Porc" type="button">Nuevo mandato de autorización propia</button>
					</a>
				</div>
			</div>
			<div class="row align-items-center justify-content-center text-center">
				<div class="col-12 col-md-6">
					<a href="#" th:href="@{/mandato/menor/true}" class="textDecoration-none">
						<button class="btn btn-warning anchoMinimo50 margenArribaAbajo3Porc" type="button">Nuevo mandato de autorización menor</button>
					</a>
				</div>
			</div>
			<div class="row align-items-center justify-content-center text-center">
				<div class="col-12 col-md-6">
					<a href="#" th:href="@{/mandato/menor/false}" class="textDecoration-none">
						<button class="btn btn-primary backgroundColorLightViolet anchoMinimo50 margenArribaAbajo3Porc" type="button">Nuevo mandato de autorización inclusiva</button>
					</a>
				</div>
			</div>
		</section>

		<section sec:authorize="isAuthenticated()">
			<table class="table table-striped table-hover">
				<thead>
				<tr>
					<th scope="col">Fecha</th>
					<th scope="col">Mandante</th>
					<th scope="col">Autorizado (menor o inclusivo)</th>
					<th scope="col">Temporada</th>
					<th class="d-none d-sm-table-cell"></th>
					<th class="d-none d-sm-table-cell"></th>
				</tr>
				</thead>
				<tbody>
				<tr th:each="mandato : ${mandatoModelList}">
					<td th:class="${!mandato.mandatoFirmado} ? 'backgroundColorRed' : ''"><span th:text="${#calendars.format(mandato.fechaAlta,'dd/MM/yyyy HH:mm')}"></span></td>
					<td th:class="${!mandato.mandatoFirmado} ? 'backgroundColorRed' : ''"><span th:text="${mandato.nombreMandante+' '+mandato.apellido1Mandante+' '+mandato.apellido2Mandante}"></span></td>
					<td th:class="${!mandato.mandatoFirmado} ? 'backgroundColorRed' : ''"><span th:if="${mandato.nombreAutorizado != null}" th:text="${mandato.nombreAutorizado+' '+mandato.apellido1Autorizado+' '+mandato.apellido2Autorizado}"></span></td>
					<td th:class="${!mandato.mandatoFirmado} ? 'backgroundColorRed' : ''"><span th:text="${mandato.temporada}"></span> <a class="d-table-cell d-sm-none colorGreen" th:if="${!mandato.mandatoFirmado}" href="#" th:href="@{/seguridad/nuevoEnvioCodigo/inscripcionMandato/__${mandato.id}__}">¡Mandato no firmado!</a></td>
					<td class="d-none d-sm-table-cell">
						<form th:if="${mandato.mandatoFirmado}" action="#" method="POST" th:action="@{/mandato/descargarPdf}" th:object="${mandatoModel}">
							<input type="hidden" name="id" th:value="${mandato.id}"/>
							<button class="btn btn-success" type="submit">Descarga</button>
						</form>
						<a th:if="${!mandato.mandatoFirmado}" class="colorRed" href="#" th:href="@{/seguridad/nuevoEnvioCodigo/inscripcionMandato/__${mandato.id}__}">¡Mandato no firmado! Toque aquí para firmar</a>
					</td>
					<td class="d-none d-sm-table-cell">
						<button th:if="${!mandato.mandatoFirmado}" class="btn btn-danger" th:attr="onclick=|confirmDelete('${mandato.id}')|">Borrar mandato</button>
					</td>
				</tr>
				</tbody>
			</table>
		</section>
		
	</div>
</body>

<footer th:replace="static/footer :: footer"></footer>
</html>