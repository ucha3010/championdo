<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" lang="es">
<head>
	<meta th:replace="static/cabeceraMeta :: meta">
	<link th:replace="static/cabeceraLink :: link">
	<script th:replace="static/cabeceraScript :: script"></script>
	<script th:replace="static/cabeceraScriptJquery :: script"></script>
	<script th:replace="static/cabeceraScriptTable :: script"></script>

	<title>Usuarios</title>

	<script type="text/javascript">
		function selectActivity(){
			var relativeUrl = "usuario/gymUsers/activity/" + document.getElementById('activity').selectedOptions[0].value;
			var domain = getDomain(location.href);
			location.href = domain + relativeUrl;
		}

        function viewDetail(username,adultUsername){
			var userIdCard;
        	if (username !== null && username.trim() !== "null" && username.trim() !== "") {
				userIdCard = username;
        	} else {
        		userIdCard = adultUsername;
        	}
            var relativeUrl = "usuario/gymUsers/" + userIdCard;
            var domain = getDomain(location.href);
            location.href = domain + relativeUrl;
        }
	</script>
</head>
<body>
	<div th:replace="static/barraUsuario :: div"></div>
	<div th:replace="static/barraNav :: nav"></div>

	<div class="container">

		<section>
			<div class="row align-items-center justify-content-end">
				<div class="col-3 col-md-2">
					<a class="btn btn-info" href="#" th:href="@{/adminGimnasio/}">Volver</a>
				</div>
			</div>
			<div class="row mb-1 text-center">
				<div class="col-12 colorGreen">
					<h1>Usuarios<span th:if="${selectedActivity != null}" th:text="' (' + ${selectedActivity} + ')'"></span></h1>
				</div>
			</div>
		</section>

		<section sec:authorize="hasRole('ROLE_ADMIN')">
			<div class="row mb-3">
				<div class="col-8 col-md-4">
					<select id="activity" class="form-select">
						<option th:each="c : ${activities}" th:value="${c.clave}" th:text="${c.valor}"></option>
					</select>
				</div>
				<div class="col-4">
					<button type="button" class="btn btn-success" onclick="selectActivity()">Filtrar</button>
				</div>
			</div>
		</section>

		<section sec:authorize="hasRole('ROLE_ADMIN')">
			<table class="table table-striped table-hover sortable">
				<thead>
					<tr class="align-middle">
						<th><button class="btn btn-link">DNI Adulto<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Nombre<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Primer apellido<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Segundo apellido<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Autorizado Nombre<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Autorizado Primer apellido<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Autorizado Segundo apellido<span aria-hidden="true"></span></button></th>
						<th><button class="btn btn-link">Inscripciones<span aria-hidden="true"></span></button></th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="user : ${userRegistrationList}" th:attr="onclick=|viewDetail('${user.username}','${user.usernameACargo}')|">
						<td th:if="${user.username != null}"><span th:text="${user.username}"></span></td>
						<td th:if="${user.username != null}"><span th:text="${user.name}"></span></td>
						<td th:if="${user.username != null}"><span th:text="${user.lastname}"></span></td>
						<td th:if="${user.username != null}"><span th:text="${user.secondLastname}"></span></td>
						<td th:if="${user.username != null}"></td>
						<td th:if="${user.username != null}"></td>
						<td th:if="${user.username != null}"></td>

						<td th:if="${user.username == null}"><span th:text="${user.usernameACargo}"></span></td>
						<td th:if="${user.username == null}"></td>
						<td th:if="${user.username == null}"></td>
						<td th:if="${user.username == null}"></td>
						<td th:if="${user.username == null}"><span th:text="${user.name}"></span></td>
						<td th:if="${user.username == null}"><span th:text="${user.lastname}"></span></td>
						<td th:if="${user.username == null}"><span th:text="${user.secondLastname}"></span></td>

						<td><span th:text="${user.registrations}"></span></td>
					</tr>
				</tbody>
			</table>
		</section>

		<section th:if="${not #lists.isEmpty(userRegistrationList)}" sec:authorize="hasRole('ROLE_ADMIN')">
			<div class="row align-items-center justify-content-end">
				<div class="col-3 col-md-2">
					<a class="btn btn-info" href="#" th:href="@{/adminGimnasio/}">Volver</a>
				</div>
			</div>
		</section>
	</div>
</body>

<footer th:replace="static/footer :: footer"></footer>
</html>